import{c as e,I as t,T as r,S as a,J as n,Z as o,A as s,a as i,b as l,u,d as c,o as p,r as m,s as d,l as f,e as g,i as h,f as y,g as v,n as b,h as x,j as _,k as w,m as I}from"./types-DH8sDsgV.js";import{E as T,p as A,L as S,U as E}from"./types-DH8sDsgV.js";import"./index-CCeDs9WQ.js";var k=({prefix:r,size:a=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:o="-"}={})=>{const s=e(n,a);if(null==r)return s;if(n.includes(o))throw new t({argument:"separator",message:`The separator "${o}" must not be part of the alphabet "${n}".`});return e=>`${r}${o}${s(e)}`};k();var R=Symbol.for("vercel.ai.validator");function N(e){return function(e){return"object"==typeof e&&null!==e&&R in e&&!0===e[R]&&"validate"in e}(e)?e:(t=e,r=e=>{const r=t.safeParse(e);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}},{[R]:!0,validate:r});var t,r}function C({value:e,schema:t}){const a=N(t);try{if(null==a.validate)return{success:!0,value:e};const t=a.validate(e);return t.success?t:{success:!1,error:r.wrap({value:e,cause:t.error})}}catch(n){return{success:!1,error:r.wrap({value:e,cause:n})}}}function O({text:e,schema:t}){try{const r=a.parse(e);if(null==t)return{success:!0,value:r,rawValue:r};const n=C({value:r,schema:t});return n.success?{...n,rawValue:r}:n}catch(r){return{success:!1,error:n.isInstance(r)?r:new n({text:e,cause:r})}}}var{btoa:P,atob:M}=globalThis;function j(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),r=M(t);return Uint8Array.from(r,e=>e.codePointAt(0))}function $(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCodePoint(e[r]);return P(t)}const D=Symbol("Let zodToJsonSchema decide on which parser to use"),L={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref",openAiAnyTypeName:"OpenAiAnyType"},U=e=>{const t=(e=>"string"==typeof e?{...L,name:e}:{...L,...e})(e),r=void 0!==t.name?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,flags:{hasReferencedOpenAiAnyType:!1},currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([e,r])=>[r._def,{def:r._def,path:[...t.basePath,t.definitionPath,e],jsonSchema:void 0}]))}};function Z(e,t,r,a){a?.errorMessages&&r&&(e.errorMessage={...e.errorMessage,[t]:r})}function F(e,t,r,a,n){e[t]=r,Z(e,t,a,n)}const B=(e,t)=>{let r=0;for(;r<e.length&&r<t.length&&e[r]===t[r];r++);return[(e.length-r).toString(),...t.slice(r)].join("/")};function J(e){if("openAi"!==e.target)return{};const t=[...e.basePath,e.definitionPath,e.openAiAnyTypeName];return e.flags.hasReferencedOpenAiAnyType=!0,{$ref:"relative"===e.$refStrategy?B(t,e.currentPath):t.join("/")}}function q(e,t){return ye(e.type._def,t)}function V(e,t,r){const a=r??t.dateStrategy;if(Array.isArray(a))return{anyOf:a.map((r,a)=>V(e,t,r))};switch(a){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return z(e,t)}}const z=(e,t)=>{const r={type:"integer",format:"unix-time"};if("openApi3"===t.target)return r;for(const a of e.checks)switch(a.kind){case"min":F(r,"minimum",a.value,a.message,t);break;case"max":F(r,"maximum",a.value,a.message,t)}return r};let Y;const K=/^[cC][^\s-]{8,}$/,W=/^[0-9a-z]+$/,G=/^[0-9A-HJKMNP-TV-Z]{26}$/,H=/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,X=()=>(void 0===Y&&(Y=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Y),Q=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ee=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,te=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,re=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,ae=/^[a-zA-Z0-9_-]{21}$/,ne=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/;function oe(e,t){const r={type:"string"};if(e.checks)for(const a of e.checks)switch(a.kind){case"min":F(r,"minLength","number"==typeof r.minLength?Math.max(r.minLength,a.value):a.value,a.message,t);break;case"max":F(r,"maxLength","number"==typeof r.maxLength?Math.min(r.maxLength,a.value):a.value,a.message,t);break;case"email":switch(t.emailStrategy){case"format:email":le(r,"email",a.message,t);break;case"format:idn-email":le(r,"idn-email",a.message,t);break;case"pattern:zod":ue(r,H,a.message,t)}break;case"url":le(r,"uri",a.message,t);break;case"uuid":le(r,"uuid",a.message,t);break;case"regex":ue(r,a.regex,a.message,t);break;case"cuid":ue(r,K,a.message,t);break;case"cuid2":ue(r,W,a.message,t);break;case"startsWith":ue(r,RegExp(`^${se(a.value,t)}`),a.message,t);break;case"endsWith":ue(r,RegExp(`${se(a.value,t)}$`),a.message,t);break;case"datetime":le(r,"date-time",a.message,t);break;case"date":le(r,"date",a.message,t);break;case"time":le(r,"time",a.message,t);break;case"duration":le(r,"duration",a.message,t);break;case"length":F(r,"minLength","number"==typeof r.minLength?Math.max(r.minLength,a.value):a.value,a.message,t),F(r,"maxLength","number"==typeof r.maxLength?Math.min(r.maxLength,a.value):a.value,a.message,t);break;case"includes":ue(r,RegExp(se(a.value,t)),a.message,t);break;case"ip":"v6"!==a.version&&le(r,"ipv4",a.message,t),"v4"!==a.version&&le(r,"ipv6",a.message,t);break;case"base64url":ue(r,re,a.message,t);break;case"jwt":ue(r,ne,a.message,t);break;case"cidr":"v6"!==a.version&&ue(r,Q,a.message,t),"v4"!==a.version&&ue(r,ee,a.message,t);break;case"emoji":ue(r,X(),a.message,t);break;case"ulid":ue(r,G,a.message,t);break;case"base64":switch(t.base64Strategy){case"format:binary":le(r,"binary",a.message,t);break;case"contentEncoding:base64":F(r,"contentEncoding","base64",a.message,t);break;case"pattern:zod":ue(r,te,a.message,t)}break;case"nanoid":ue(r,ae,a.message,t)}return r}function se(e,t){return"escape"===t.patternStrategy?function(e){let t="";for(let r=0;r<e.length;r++)ie.has(e[r])||(t+="\\"),t+=e[r];return t}(e):e}const ie=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function le(e,t,r,a){e.format||e.anyOf?.some(e=>e.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&a.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.anyOf.push({format:t,...r&&a.errorMessages&&{errorMessage:{format:r}}})):F(e,"format",t,r,a)}function ue(e,t,r,a){e.pattern||e.allOf?.some(e=>e.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&a.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.allOf.push({pattern:ce(t,a),...r&&a.errorMessages&&{errorMessage:{pattern:r}}})):F(e,"pattern",ce(t,a),r,a)}function ce(e,t){if(!t.applyRegexFlags||!e.flags)return e.source;const r=e.flags.includes("i"),a=e.flags.includes("m"),n=e.flags.includes("s"),o=r?e.source.toLowerCase():e.source;let s="",i=!1,l=!1,u=!1;for(let c=0;c<o.length;c++)if(i)s+=o[c],i=!1;else{if(r)if(l){if(o[c].match(/[a-z]/)){u?(s+=o[c],s+=`${o[c-2]}-${o[c]}`.toUpperCase(),u=!1):"-"===o[c+1]&&o[c+2]?.match(/[a-z]/)?(s+=o[c],u=!0):s+=`${o[c]}${o[c].toUpperCase()}`;continue}}else if(o[c].match(/[a-z]/)){s+=`[${o[c]}${o[c].toUpperCase()}]`;continue}if(a){if("^"===o[c]){s+="(^|(?<=[\r\n]))";continue}if("$"===o[c]){s+="($|(?=[\r\n]))";continue}}n&&"."===o[c]?s+=l?`${o[c]}\r\n`:`[${o[c]}\r\n]`:(s+=o[c],"\\"===o[c]?i=!0:l&&"]"===o[c]?l=!1:l||"["!==o[c]||(l=!0))}try{new RegExp(s)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return s}function pe(e,t){if("openAi"===t.target&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),"openApi3"===t.target&&e.keyType?._def.typeName===o.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((r,a)=>({...r,[a]:ye(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",a]})??J(t)}),{}),additionalProperties:t.rejectedAdditionalProperties};const r={type:"object",additionalProperties:ye(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??t.allowedAdditionalProperties};if("openApi3"===t.target)return r;if(e.keyType?._def.typeName===o.ZodString&&e.keyType._def.checks?.length){const{type:a,...n}=oe(e.keyType._def,t);return{...r,propertyNames:n}}if(e.keyType?._def.typeName===o.ZodEnum)return{...r,propertyNames:{enum:e.keyType._def.values}};if(e.keyType?._def.typeName===o.ZodBranded&&e.keyType._def.type._def.typeName===o.ZodString&&e.keyType._def.type._def.checks?.length){const{type:a,...n}=q(e.keyType._def,t);return{...r,propertyNames:n}}return r}const me={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};const de=(e,t)=>{const r=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((e,r)=>ye(e._def,{...t,currentPath:[...t.currentPath,"anyOf",`${r}`]})).filter(e=>!!e&&(!t.strictUnions||"object"==typeof e&&Object.keys(e).length>0));return r.length?{anyOf:r}:void 0};function fe(e,t){const r="openAi"===t.target,a={type:"object",properties:{}},n=[],o=e.shape();for(const i in o){let e=o[i];if(void 0===e||void 0===e._def)continue;let s=ge(e);s&&r&&("ZodOptional"===e._def.typeName&&(e=e._def.innerType),e.isNullable()||(e=e.nullable()),s=!1);const l=ye(e._def,{...t,currentPath:[...t.currentPath,"properties",i],propertyPath:[...t.currentPath,"properties",i]});void 0!==l&&(a.properties[i]=l,s||n.push(i))}n.length&&(a.required=n);const s=function(e,t){if("ZodNever"!==e.catchall._def.typeName)return ye(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return"strict"===t.removeAdditionalStrategy?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}(e,t);return void 0!==s&&(a.additionalProperties=s),a}function ge(e){try{return e.isOptional()}catch{return!0}}const he=(e,t,r)=>{switch(t){case o.ZodString:return oe(e,r);case o.ZodNumber:return function(e,t){const r={type:"number"};if(!e.checks)return r;for(const a of e.checks)switch(a.kind){case"int":r.type="integer",Z(r,"type",a.message,t);break;case"min":"jsonSchema7"===t.target?a.inclusive?F(r,"minimum",a.value,a.message,t):F(r,"exclusiveMinimum",a.value,a.message,t):(a.inclusive||(r.exclusiveMinimum=!0),F(r,"minimum",a.value,a.message,t));break;case"max":"jsonSchema7"===t.target?a.inclusive?F(r,"maximum",a.value,a.message,t):F(r,"exclusiveMaximum",a.value,a.message,t):(a.inclusive||(r.exclusiveMaximum=!0),F(r,"maximum",a.value,a.message,t));break;case"multipleOf":F(r,"multipleOf",a.value,a.message,t)}return r}(e,r);case o.ZodObject:return fe(e,r);case o.ZodBigInt:return function(e,t){const r={type:"integer",format:"int64"};if(!e.checks)return r;for(const a of e.checks)switch(a.kind){case"min":"jsonSchema7"===t.target?a.inclusive?F(r,"minimum",a.value,a.message,t):F(r,"exclusiveMinimum",a.value,a.message,t):(a.inclusive||(r.exclusiveMinimum=!0),F(r,"minimum",a.value,a.message,t));break;case"max":"jsonSchema7"===t.target?a.inclusive?F(r,"maximum",a.value,a.message,t):F(r,"exclusiveMaximum",a.value,a.message,t):(a.inclusive||(r.exclusiveMaximum=!0),F(r,"maximum",a.value,a.message,t));break;case"multipleOf":F(r,"multipleOf",a.value,a.message,t)}return r}(e,r);case o.ZodBoolean:return{type:"boolean"};case o.ZodDate:return V(e,r);case o.ZodUndefined:return function(e){return{not:J(e)}}(r);case o.ZodNull:return function(e){return"openApi3"===e.target?{enum:["null"],nullable:!0}:{type:"null"}}(r);case o.ZodArray:return function(e,t){const r={type:"array"};return e.type?._def&&e.type?._def?.typeName!==o.ZodAny&&(r.items=ye(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&F(r,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&F(r,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(F(r,"minItems",e.exactLength.value,e.exactLength.message,t),F(r,"maxItems",e.exactLength.value,e.exactLength.message,t)),r}(e,r);case o.ZodUnion:case o.ZodDiscriminatedUnion:return function(e,t){if("openApi3"===t.target)return de(e,t);const r=e.options instanceof Map?Array.from(e.options.values()):e.options;if(r.every(e=>e._def.typeName in me&&(!e._def.checks||!e._def.checks.length))){const e=r.reduce((e,t)=>{const r=me[t._def.typeName];return r&&!e.includes(r)?[...e,r]:e},[]);return{type:e.length>1?e:e[0]}}if(r.every(e=>"ZodLiteral"===e._def.typeName&&!e.description)){const e=r.reduce((e,t)=>{const r=typeof t._def.value;switch(r){case"string":case"number":case"boolean":return[...e,r];case"bigint":return[...e,"integer"];case"object":if(null===t._def.value)return[...e,"null"];default:return e}},[]);if(e.length===r.length){const t=e.filter((e,t,r)=>r.indexOf(e)===t);return{type:t.length>1?t:t[0],enum:r.reduce((e,t)=>e.includes(t._def.value)?e:[...e,t._def.value],[])}}}else if(r.every(e=>"ZodEnum"===e._def.typeName))return{type:"string",enum:r.reduce((e,t)=>[...e,...t._def.values.filter(t=>!e.includes(t))],[])};return de(e,t)}(e,r);case o.ZodIntersection:return function(e,t){const r=[ye(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),ye(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(e=>!!e);let a="jsonSchema2019-09"===t.target?{unevaluatedProperties:!1}:void 0;const n=[];return r.forEach(e=>{if("type"in(t=e)&&"string"===t.type||!("allOf"in t)){let t=e;if("additionalProperties"in e&&!1===e.additionalProperties){const{additionalProperties:r,...a}=e;t=a}else a=void 0;n.push(t)}else n.push(...e.allOf),void 0===e.unevaluatedProperties&&(a=void 0);var t}),n.length?{allOf:n,...a}:void 0}(e,r);case o.ZodTuple:return function(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((e,r)=>ye(e._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[]),additionalItems:ye(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((e,r)=>ye(e._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[])}}(e,r);case o.ZodRecord:return pe(e,r);case o.ZodLiteral:return function(e,t){const r=typeof e.value;return"bigint"!==r&&"number"!==r&&"boolean"!==r&&"string"!==r?{type:Array.isArray(e.value)?"array":"object"}:"openApi3"===t.target?{type:"bigint"===r?"integer":r,enum:[e.value]}:{type:"bigint"===r?"integer":r,const:e.value}}(e,r);case o.ZodEnum:return function(e){return{type:"string",enum:Array.from(e.values)}}(e);case o.ZodNativeEnum:return function(e){const t=e.values,r=Object.keys(e.values).filter(e=>"number"!=typeof t[t[e]]).map(e=>t[e]),a=Array.from(new Set(r.map(e=>typeof e)));return{type:1===a.length?"string"===a[0]?"string":"number":["string","number"],enum:r}}(e);case o.ZodNullable:return function(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return"openApi3"===t.target?{type:me[e.innerType._def.typeName],nullable:!0}:{type:[me[e.innerType._def.typeName],"null"]};if("openApi3"===t.target){const r=ye(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const r=ye(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}(e,r);case o.ZodOptional:return((e,t)=>{if(t.currentPath.toString()===t.propertyPath?.toString())return ye(e.innerType._def,t);const r=ye(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return r?{anyOf:[{not:J(t)},r]}:J(t)})(e,r);case o.ZodMap:return function(e,t){return"record"===t.mapStrategy?pe(e,t):{type:"array",maxItems:125,items:{type:"array",items:[ye(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||J(t),ye(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||J(t)],minItems:2,maxItems:2}}}(e,r);case o.ZodSet:return function(e,t){const r={type:"array",uniqueItems:!0,items:ye(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&F(r,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&F(r,"maxItems",e.maxSize.value,e.maxSize.message,t),r}(e,r);case o.ZodLazy:return()=>e.getter()._def;case o.ZodPromise:return function(e,t){return ye(e.type._def,t)}(e,r);case o.ZodNaN:case o.ZodNever:return function(e){return"openAi"===e.target?void 0:{not:J({...e,currentPath:[...e.currentPath,"not"]})}}(r);case o.ZodEffects:return function(e,t){return"input"===t.effectStrategy?ye(e.schema._def,t):J(t)}(e,r);case o.ZodAny:return J(r);case o.ZodUnknown:return function(e){return J(e)}(r);case o.ZodDefault:return function(e,t){return{...ye(e.innerType._def,t),default:e.defaultValue()}}(e,r);case o.ZodBranded:return q(e,r);case o.ZodReadonly:case o.ZodCatch:return((e,t)=>ye(e.innerType._def,t))(e,r);case o.ZodPipeline:return((e,t)=>{if("input"===t.pipeStrategy)return ye(e.in._def,t);if("output"===t.pipeStrategy)return ye(e.out._def,t);const r=ye(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]});return{allOf:[r,ye(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",r?"1":"0"]})].filter(e=>void 0!==e)}})(e,r);case o.ZodFunction:case o.ZodVoid:case o.ZodSymbol:default:return}};function ye(e,t,r=!1){const a=t.seen.get(e);if(t.override){const n=t.override?.(e,t,a,r);if(n!==D)return n}if(a&&!r){const e=ve(a,t);if(void 0!==e)return e}const n={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,n);const o=he(e,e.typeName,t),s="function"==typeof o?ye(o(),t):o;if(s&&be(e,t,s),t.postProcess){const r=t.postProcess(s,e,t);return n.jsonSchema=s,r}return n.jsonSchema=s,s}const ve=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:B(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((e,r)=>t.currentPath[r]===e)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),J(t)):"seen"===t.$refStrategy?J(t):void 0}},be=(e,t,r)=>(e.description&&(r.description=e.description,t.markdownDescription&&(r.markdownDescription=e.description)),r);var xe={code:"0",name:"text",parse:e=>{if("string"!=typeof e)throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},_e={code:"3",name:"error",parse:e=>{if("string"!=typeof e)throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},we={code:"4",name:"assistant_message",parse:e=>{if(!(null!=e&&"object"==typeof e&&"id"in e&&"role"in e&&"content"in e&&"string"==typeof e.id&&"string"==typeof e.role&&"assistant"===e.role&&Array.isArray(e.content)&&e.content.every(e=>null!=e&&"object"==typeof e&&"type"in e&&"text"===e.type&&"text"in e&&null!=e.text&&"object"==typeof e.text&&"value"in e.text&&"string"==typeof e.text.value)))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},Ie={code:"5",name:"assistant_control_data",parse:e=>{if(null==e||"object"!=typeof e||!("threadId"in e)||!("messageId"in e)||"string"!=typeof e.threadId||"string"!=typeof e.messageId)throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},Te={code:"6",name:"data_message",parse:e=>{if(null==e||"object"!=typeof e||!("role"in e)||!("data"in e)||"string"!=typeof e.role||"data"!==e.role)throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}};function Ae(e){const t=["ROOT"];let r=-1,a=null;function n(e,n,o){switch(e){case'"':r=n,t.pop(),t.push(o),t.push("INSIDE_STRING");break;case"f":case"t":case"n":r=n,a=n,t.pop(),t.push(o),t.push("INSIDE_LITERAL");break;case"-":t.pop(),t.push(o),t.push("INSIDE_NUMBER");break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r=n,t.pop(),t.push(o),t.push("INSIDE_NUMBER");break;case"{":r=n,t.pop(),t.push(o),t.push("INSIDE_OBJECT_START");break;case"[":r=n,t.pop(),t.push(o),t.push("INSIDE_ARRAY_START")}}function o(e,a){switch(e){case",":t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break;case"}":r=a,t.pop()}}function s(e,a){switch(e){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":r=a,t.pop()}}for(let l=0;l<e.length;l++){const i=e[l];switch(t[t.length-1]){case"ROOT":n(i,l,"FINISH");break;case"INSIDE_OBJECT_START":switch(i){case'"':t.pop(),t.push("INSIDE_OBJECT_KEY");break;case"}":r=l,t.pop()}break;case"INSIDE_OBJECT_AFTER_COMMA":if('"'===i)t.pop(),t.push("INSIDE_OBJECT_KEY");break;case"INSIDE_OBJECT_KEY":if('"'===i)t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY");break;case"INSIDE_OBJECT_AFTER_KEY":if(":"===i)t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE");break;case"INSIDE_OBJECT_BEFORE_VALUE":n(i,l,"INSIDE_OBJECT_AFTER_VALUE");break;case"INSIDE_OBJECT_AFTER_VALUE":o(i,l);break;case"INSIDE_STRING":switch(i){case'"':t.pop(),r=l;break;case"\\":t.push("INSIDE_STRING_ESCAPE");break;default:r=l}break;case"INSIDE_ARRAY_START":if("]"===i)r=l,t.pop();else r=l,n(i,l,"INSIDE_ARRAY_AFTER_VALUE");break;case"INSIDE_ARRAY_AFTER_VALUE":switch(i){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":r=l,t.pop();break;default:r=l}break;case"INSIDE_ARRAY_AFTER_COMMA":n(i,l,"INSIDE_ARRAY_AFTER_VALUE");break;case"INSIDE_STRING_ESCAPE":t.pop(),r=l;break;case"INSIDE_NUMBER":switch(i){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r=l;break;case"e":case"E":case"-":case".":break;case",":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&s(i,l),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&o(i,l);break;case"}":t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&o(i,l);break;case"]":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&s(i,l);break;default:t.pop()}break;case"INSIDE_LITERAL":{const n=e.substring(a,l+1);"false".startsWith(n)||"true".startsWith(n)||"null".startsWith(n)?r=l:(t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]?o(i,l):"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&s(i,l));break}}}let i=e.slice(0,r+1);for(let l=t.length-1;l>=0;l--){switch(t[l]){case"INSIDE_STRING":i+='"';break;case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":i+="}";break;case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":i+="]";break;case"INSIDE_LITERAL":{const t=e.substring(a,e.length);"true".startsWith(t)?i+="true".slice(t.length):"false".startsWith(t)?i+="false".slice(t.length):"null".startsWith(t)&&(i+="null".slice(t.length))}}}return i}[xe,_e,we,Ie,Te].map(e=>e.code);var Se=[{code:"0",name:"text",parse:e=>{if("string"!=typeof e)throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},{code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw new Error('"data" parts expect an array value.');return{type:"data",value:e}}},{code:"3",name:"error",parse:e=>{if("string"!=typeof e)throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},{code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw new Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},{code:"9",name:"tool_call",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("toolName"in e)||"string"!=typeof e.toolName||!("args"in e)||"object"!=typeof e.args)throw new Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},{code:"a",name:"tool_result",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("result"in e))throw new Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},{code:"b",name:"tool_call_streaming_start",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("toolName"in e)||"string"!=typeof e.toolName)throw new Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},{code:"c",name:"tool_call_delta",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("argsTextDelta"in e)||"string"!=typeof e.argsTextDelta)throw new Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},{code:"d",name:"finish_message",parse:e=>{if(null==e||"object"!=typeof e||!("finishReason"in e)||"string"!=typeof e.finishReason)throw new Error('"finish_message" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason};return"usage"in e&&null!=e.usage&&"object"==typeof e.usage&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:"number"==typeof e.usage.promptTokens?e.usage.promptTokens:Number.NaN,completionTokens:"number"==typeof e.usage.completionTokens?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},{code:"e",name:"finish_step",parse:e=>{if(null==e||"object"!=typeof e||!("finishReason"in e)||"string"!=typeof e.finishReason)throw new Error('"finish_step" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&null!=e.usage&&"object"==typeof e.usage&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:"number"==typeof e.usage.promptTokens?e.usage.promptTokens:Number.NaN,completionTokens:"number"==typeof e.usage.completionTokens?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&"boolean"==typeof e.isContinued&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},{code:"f",name:"start_step",parse:e=>{if(null==e||"object"!=typeof e||!("messageId"in e)||"string"!=typeof e.messageId)throw new Error('"start_step" parts expect an object with an "id" property.');return{type:"start_step",value:{messageId:e.messageId}}}},{code:"g",name:"reasoning",parse:e=>{if("string"!=typeof e)throw new Error('"reasoning" parts expect a string value.');return{type:"reasoning",value:e}}},{code:"h",name:"source",parse:e=>{if(null==e||"object"!=typeof e)throw new Error('"source" parts expect a Source object.');return{type:"source",value:e}}},{code:"i",name:"redacted_reasoning",parse:e=>{if(null==e||"object"!=typeof e||!("data"in e)||"string"!=typeof e.data)throw new Error('"redacted_reasoning" parts expect an object with a "data" property.');return{type:"redacted_reasoning",value:{data:e.data}}}},{code:"j",name:"reasoning_signature",parse:e=>{if(null==e||"object"!=typeof e||!("signature"in e)||"string"!=typeof e.signature)throw new Error('"reasoning_signature" parts expect an object with a "signature" property.');return{type:"reasoning_signature",value:{signature:e.signature}}}},{code:"k",name:"file",parse:e=>{if(null==e||"object"!=typeof e||!("data"in e)||"string"!=typeof e.data||!("mimeType"in e)||"string"!=typeof e.mimeType)throw new Error('"file" parts expect an object with a "data" and "mimeType" property.');return{type:"file",value:e}}}];function Ee(e,t){const r=Se.find(t=>t.name===e);if(!r)throw new Error(`Invalid stream part type: ${e}`);return`${r.code}:${JSON.stringify(t)}\n`}function ke(e,t){const r=null!=void 0&&undefined;return Ne(((e,t)=>{const r=U(t);let a="object"==typeof t&&t.definitions?Object.entries(t.definitions).reduce((e,[t,a])=>({...e,[t]:ye(a._def,{...r,currentPath:[...r.basePath,r.definitionPath,t]},!0)??J(r)}),{}):void 0;const n="string"==typeof t?t:"title"===t?.nameStrategy?void 0:t?.name,o=ye(e._def,void 0===n?r:{...r,currentPath:[...r.basePath,r.definitionPath,n]},!1)??J(r),s="object"==typeof t&&void 0!==t.name&&"title"===t.nameStrategy?t.name:void 0;void 0!==s&&(o.title=s),r.flags.hasReferencedOpenAiAnyType&&(a||(a={}),a[r.openAiAnyTypeName]||(a[r.openAiAnyTypeName]={type:["string","number","integer","boolean","array","null"],items:{$ref:"relative"===r.$refStrategy?"1":[...r.basePath,r.definitionPath,r.openAiAnyTypeName].join("/")}}));const i=void 0===n?a?{...o,[r.definitionPath]:a}:o:{$ref:[..."relative"===r.$refStrategy?[]:r.basePath,r.definitionPath,n].join("/"),[r.definitionPath]:{...a,[n]:o}};return"jsonSchema7"===r.target?i.$schema="http://json-schema.org/draft-07/schema#":"jsonSchema2019-09"!==r.target&&"openAi"!==r.target||(i.$schema="https://json-schema.org/draft/2019-09/schema#"),"openAi"===r.target&&("anyOf"in i||"oneOf"in i||"allOf"in i||"type"in i&&Array.isArray(i.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),i})(e,{$refStrategy:r?"root":"none",target:"jsonSchema7"}),{validate:t=>{const r=e.safeParse(t);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}}})}Object.fromEntries(Se.map(e=>[e.code,e])),Object.fromEntries(Se.map(e=>[e.name,e.code])),Se.map(e=>e.code);var Re=Symbol.for("vercel.ai.schema");function Ne(e,{validate:t}={}){return{[Re]:!0,_type:void 0,[R]:!0,jsonSchema:e,validate:t}}function Ce(e){return"object"==typeof(t=e)&&null!==t&&Re in t&&!0===t[Re]&&"jsonSchema"in t&&"validate"in t?e:ke(e);var t}var Oe="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:{},Pe="1.9.0",Me=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;var je=function(e){var t=new Set([e]),r=new Set,a=e.match(Me);if(!a)return function(){return!1};var n=+a[1],o=+a[2],s=+a[3];if(null!=a[4])return function(t){return t===e};function i(e){return r.add(e),!1}function l(e){return t.add(e),!0}return function(e){if(t.has(e))return!0;if(r.has(e))return!1;var a=e.match(Me);if(!a)return i(e);var u=+a[1],c=+a[2],p=+a[3];return null!=a[4]||n!==u?i(e):0===n?o===c&&s<=p?l(e):i(e):o<=c?l(e):i(e)}}(Pe),$e=Pe.split(".")[0],De=Symbol.for("opentelemetry.js.api."+$e),Le=Oe;function Ue(e,t,r,a){var n;void 0===a&&(a=!1);var o=Le[De]=null!==(n=Le[De])&&void 0!==n?n:{version:Pe};if(!a&&o[e]){var s=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return r.error(s.stack||s.message),!1}if(o.version!==Pe){s=new Error("@opentelemetry/api: Registration of version v"+o.version+" for "+e+" does not match previously registered API v"+Pe);return r.error(s.stack||s.message),!1}return o[e]=t,r.debug("@opentelemetry/api: Registered a global for "+e+" v"+Pe+"."),!0}function Ze(e){var t,r,a=null===(t=Le[De])||void 0===t?void 0:t.version;if(a&&je(a))return null===(r=Le[De])||void 0===r?void 0:r[e]}function Fe(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+Pe+".");var r=Le[De];r&&delete r[e]}var Be,Je,qe=function(){function e(e){this._namespace=e.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ve("debug",this._namespace,e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ve("error",this._namespace,e)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ve("info",this._namespace,e)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ve("warn",this._namespace,e)},e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ve("verbose",this._namespace,e)},e}();function Ve(e,t,r){var a=Ze("diag");if(a)return r.unshift(t),a[e].apply(a,function(e,t,r){if(r||2===arguments.length)for(var a,n=0,o=t.length;n<o;n++)!a&&n in t||(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}([],function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var a,n,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)s.push(a.value)}catch(i){n={error:i}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return s}(r),!1))}(Je=Be||(Be={}))[Je.NONE=0]="NONE",Je[Je.ERROR=30]="ERROR",Je[Je.WARN=50]="WARN",Je[Je.INFO=60]="INFO",Je[Je.DEBUG=70]="DEBUG",Je[Je.VERBOSE=80]="VERBOSE",Je[Je.ALL=9999]="ALL";var ze=function(){function e(){function e(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var a=Ze("diag");if(a)return a[e].apply(a,function(e,t,r){if(r||2===arguments.length)for(var a,n=0,o=t.length;n<o;n++)!a&&n in t||(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}([],function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var a,n,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)s.push(a.value)}catch(i){n={error:i}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return s}(t),!1))}}var t=this;t.setLogger=function(e,r){var a,n,o;if(void 0===r&&(r={logLevel:Be.INFO}),e===t){var s=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return t.error(null!==(a=s.stack)&&void 0!==a?a:s.message),!1}"number"==typeof r&&(r={logLevel:r});var i=Ze("diag"),l=function(e,t){function r(r,a){var n=t[r];return"function"==typeof n&&e>=a?n.bind(t):function(){}}return e<Be.NONE?e=Be.NONE:e>Be.ALL&&(e=Be.ALL),t=t||{},{error:r("error",Be.ERROR),warn:r("warn",Be.WARN),info:r("info",Be.INFO),debug:r("debug",Be.DEBUG),verbose:r("verbose",Be.VERBOSE)}}(null!==(n=r.logLevel)&&void 0!==n?n:Be.INFO,e);if(i&&!r.suppressOverrideMessage){var u=null!==(o=(new Error).stack)&&void 0!==o?o:"<failed to generate stacktrace>";i.warn("Current logger will be overwritten from "+u),l.warn("Current logger will overwrite one already registered from "+u)}return Ue("diag",l,t,!0)},t.disable=function(){Fe("diag",t)},t.createComponentLogger=function(e){return new qe(e)},t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}();var Ye,Ke,We=new(function(){return function e(t){var r=this;r._currentContext=t?new Map(t):new Map,r.getValue=function(e){return r._currentContext.get(e)},r.setValue=function(t,a){var n=new e(r._currentContext);return n._currentContext.set(t,a),n},r.deleteValue=function(t){var a=new e(r._currentContext);return a._currentContext.delete(t),a}}}()),Ge=function(){function e(){}return e.prototype.active=function(){return We},e.prototype.with=function(e,t,r){for(var a=[],n=3;n<arguments.length;n++)a[n-3]=arguments[n];return t.call.apply(t,function(e,t,r){if(r||2===arguments.length)for(var a,n=0,o=t.length;n<o;n++)!a&&n in t||(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}([r],function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var a,n,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)s.push(a.value)}catch(i){n={error:i}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return s}(a),!1))},e.prototype.bind=function(e,t){return t},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),He="context",Xe=new Ge,Qe=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(e){return Ue(He,e,ze.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(e,t,r){for(var a,n=[],o=3;o<arguments.length;o++)n[o-3]=arguments[o];return(a=this._getContextManager()).with.apply(a,function(e,t,r){if(r||2===arguments.length)for(var a,n=0,o=t.length;n<o;n++)!a&&n in t||(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}([e,t,r],function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var a,n,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(a=o.next()).done;)s.push(a.value)}catch(i){n={error:i}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return s}(n),!1))},e.prototype.bind=function(e,t){return this._getContextManager().bind(e,t)},e.prototype._getContextManager=function(){return Ze(He)||Xe},e.prototype.disable=function(){this._getContextManager().disable(),Fe(He,ze.instance())},e}();(Ke=Ye||(Ye={}))[Ke.NONE=0]="NONE",Ke[Ke.SAMPLED=1]="SAMPLED";var et,tt="0000000000000000",rt="00000000000000000000000000000000",at={traceId:rt,spanId:tt,traceFlags:Ye.NONE},nt=function(){function e(e){void 0===e&&(e=at),this._spanContext=e}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(e,t){return this},e.prototype.setAttributes=function(e){return this},e.prototype.addEvent=function(e,t){return this},e.prototype.addLink=function(e){return this},e.prototype.addLinks=function(e){return this},e.prototype.setStatus=function(e){return this},e.prototype.updateName=function(e){return this},e.prototype.end=function(e){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(e,t){},e}(),ot=(et="OpenTelemetry Context Key SPAN",Symbol.for(et));function st(e){return e.getValue(ot)||void 0}function it(){return st(Qe.getInstance().active())}function lt(e,t){return e.setValue(ot,t)}function ut(e){return e.deleteValue(ot)}function ct(e,t){return lt(e,new nt(t))}function pt(e){var t;return null===(t=st(e))||void 0===t?void 0:t.spanContext()}var mt=/^([0-9a-f]{32})$/i,dt=/^[0-9a-f]{16}$/i;function ft(e){return r=e.traceId,mt.test(r)&&r!==rt&&(t=e.spanId,dt.test(t)&&t!==tt);var t,r}function gt(e){return new nt(e)}var ht=Qe.getInstance(),yt=function(){function e(){}return e.prototype.startSpan=function(e,t,r){if(void 0===r&&(r=ht.active()),Boolean(null==t?void 0:t.root))return new nt;var a,n=r&&pt(r);return"object"==typeof(a=n)&&"string"==typeof a.spanId&&"string"==typeof a.traceId&&"number"==typeof a.traceFlags&&ft(n)?new nt(n):new nt},e.prototype.startActiveSpan=function(e,t,r,a){var n,o,s;if(!(arguments.length<2)){2===arguments.length?s=t:3===arguments.length?(n=t,s=r):(n=t,o=r,s=a);var i=null!=o?o:ht.active(),l=this.startSpan(e,n,i),u=lt(i,l);return ht.with(u,s,void 0,l)}},e}();var vt,bt,xt=new yt,_t=function(){function e(e,t,r,a){this._provider=e,this.name=t,this.version=r,this.options=a}return e.prototype.startSpan=function(e,t,r){return this._getTracer().startSpan(e,t,r)},e.prototype.startActiveSpan=function(e,t,r,a){var n=this._getTracer();return Reflect.apply(n.startActiveSpan,n,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):xt},e}(),wt=new(function(){function e(){}return e.prototype.getTracer=function(e,t,r){return new yt},e}()),It=function(){function e(){}return e.prototype.getTracer=function(e,t,r){var a;return null!==(a=this.getDelegateTracer(e,t,r))&&void 0!==a?a:new _t(this,e,t,r)},e.prototype.getDelegate=function(){var e;return null!==(e=this._delegate)&&void 0!==e?e:wt},e.prototype.setDelegate=function(e){this._delegate=e},e.prototype.getDelegateTracer=function(e,t,r){var a;return null===(a=this._delegate)||void 0===a?void 0:a.getTracer(e,t,r)},e}();(bt=vt||(vt={}))[bt.UNSET=0]="UNSET",bt[bt.OK=1]="OK",bt[bt.ERROR=2]="ERROR";var Tt="trace",At=function(){function e(){this._proxyTracerProvider=new It,this.wrapSpanContext=gt,this.isSpanContextValid=ft,this.deleteSpan=ut,this.getSpan=st,this.getActiveSpan=it,this.getSpanContext=pt,this.setSpan=lt,this.setSpanContext=ct}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(e){var t=Ue(Tt,this._proxyTracerProvider,ze.instance());return t&&this._proxyTracerProvider.setDelegate(e),t},e.prototype.getTracerProvider=function(){return Ze(Tt)||this._proxyTracerProvider},e.prototype.getTracer=function(e,t){return this.getTracerProvider().getTracer(e,t)},e.prototype.disable=function(){Fe(Tt,ze.instance()),this._proxyTracerProvider=new It},e}().getInstance(),St=Object.defineProperty,Et=(e,t)=>{for(var r in t)St(e,r,{get:t[r],enumerable:!0})};function kt(e,{contentType:t,dataStreamVersion:r}){const a=new Headers(null!=e?e:{});return a.has("Content-Type")||a.set("Content-Type",t),a.set("X-Vercel-AI-Data-Stream",r),a}var Rt,Nt=class extends s{constructor(){super({name:"AI_UnsupportedModelVersionError",message:'Unsupported model version. AI SDK 4 only supports models that implement specification version "v1". Please upgrade to AI SDK 5 to use this model.'})}},Ct="AI_InvalidArgumentError",Ot=`vercel.ai.error.${Ct}`,Pt=Symbol.for(Ot),Mt=class extends s{constructor({parameter:e,value:t,message:r}){super({name:Ct,message:`Invalid argument for parameter ${e}: ${r}`}),this[Rt]=!0,this.parameter=e,this.value=t}static isInstance(e){return s.hasMarker(e,Ot)}};Rt=Pt;var jt,$t="AI_RetryError",Dt=`vercel.ai.error.${$t}`,Lt=Symbol.for(Dt),Ut=class extends s{constructor({message:e,reason:t,errors:r}){super({name:$t,message:e}),this[jt]=!0,this.reason=t,this.errors=r,this.lastError=r[r.length-1]}static isInstance(e){return s.hasMarker(e,Dt)}};jt=Lt;var Zt=({maxRetries:e=2,initialDelayInMs:t=2e3,backoffFactor:r=2}={})=>async a=>Ft(a,{maxRetries:e,delayInMs:t,backoffFactor:r});async function Ft(e,{maxRetries:t,delayInMs:r,backoffFactor:a},n=[]){try{return await e()}catch(o){if(function(e){return e instanceof Error&&("AbortError"===e.name||"TimeoutError"===e.name)}(o))throw o;if(0===t)throw o;const s=function(e){return null==e?"unknown error":"string"==typeof e?e:e instanceof Error?e.message:JSON.stringify(e)}(o),i=[...n,o],l=i.length;if(l>t)throw new Ut({message:`Failed after ${l} attempts. Last error: ${s}`,reason:"maxRetriesExceeded",errors:i});if(o instanceof Error&&c.isInstance(o)&&!0===o.isRetryable&&l<=t)return await async function(e){return null==e?Promise.resolve():new Promise(t=>setTimeout(t,e))}(r),Ft(e,{maxRetries:t,delayInMs:a*r,backoffFactor:a},i);if(1===l)throw o;throw new Ut({message:`Failed after ${l} attempts with non-retryable error: '${s}'`,reason:"errorNotRetryable",errors:i})}}function Bt({operationId:e,telemetry:t}){return{"operation.name":`${e}${null!=(null==t?void 0:t.functionId)?` ${t.functionId}`:""}`,"resource.name":null==t?void 0:t.functionId,"ai.operationId":e,"ai.telemetry.functionId":null==t?void 0:t.functionId}}var Jt={startSpan:()=>qt,startActiveSpan:(e,t,r,a)=>"function"==typeof t?t(qt):"function"==typeof r?r(qt):"function"==typeof a?a(qt):void 0},qt={spanContext:()=>Vt,setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording:()=>!1,recordException(){return this}},Vt={traceId:"",spanId:"",traceFlags:0};function zt({name:e,tracer:t,attributes:r,fn:a,endWhenDone:n=!0}){return t.startActiveSpan(e,{attributes:r},async e=>{try{const t=await a(e);return n&&e.end(),t}catch(t){try{Yt(e,t)}finally{e.end()}throw t}})}function Yt(e,t){t instanceof Error?(e.recordException({name:t.name,message:t.message,stack:t.stack}),e.setStatus({code:vt.ERROR,message:t.message})):e.setStatus({code:vt.ERROR})}function Kt({telemetry:e,attributes:t}){return!0!==(null==e?void 0:e.isEnabled)?{}:Object.entries(t).reduce((t,[r,a])=>{if(void 0===a)return t;if("object"==typeof a&&"input"in a&&"function"==typeof a.input){if(!1===(null==e?void 0:e.recordInputs))return t;const n=a.input();return void 0===n?t:{...t,[r]:n}}if("object"==typeof a&&"output"in a&&"function"==typeof a.output){if(!1===(null==e?void 0:e.recordOutputs))return t;const n=a.output();return void 0===n?t:{...t,[r]:n}}return{...t,[r]:a}},{})}var Wt=class{constructor({data:e,mimeType:t}){const r=e instanceof Uint8Array;this.base64Data=r?void 0:e,this.uint8ArrayData=r?e:void 0,this.mimeType=t}get base64(){return null==this.base64Data&&(this.base64Data=$(this.uint8ArrayData)),this.base64Data}get uint8Array(){return null==this.uint8ArrayData&&(this.uint8ArrayData=j(this.base64Data)),this.uint8ArrayData}},Gt=[{mimeType:"image/gif",bytesPrefix:[71,73,70],base64Prefix:"R0lG"},{mimeType:"image/png",bytesPrefix:[137,80,78,71],base64Prefix:"iVBORw"},{mimeType:"image/jpeg",bytesPrefix:[255,216],base64Prefix:"/9j/"},{mimeType:"image/webp",bytesPrefix:[82,73,70,70],base64Prefix:"UklGRg"},{mimeType:"image/bmp",bytesPrefix:[66,77],base64Prefix:"Qk"},{mimeType:"image/tiff",bytesPrefix:[73,73,42,0],base64Prefix:"SUkqAA"},{mimeType:"image/tiff",bytesPrefix:[77,77,0,42],base64Prefix:"TU0AKg"},{mimeType:"image/avif",bytesPrefix:[0,0,0,32,102,116,121,112,97,118,105,102],base64Prefix:"AAAAIGZ0eXBhdmlm"},{mimeType:"image/heic",bytesPrefix:[0,0,0,32,102,116,121,112,104,101,105,99],base64Prefix:"AAAAIGZ0eXBoZWlj"}];function Ht(e){return"string"==typeof e&&e.startsWith("SUQz")||"string"!=typeof e&&e.length>10&&73===e[0]&&68===e[1]&&51===e[2]?(e=>{const t="string"==typeof e?j(e):e,r=(127&t[6])<<21|(127&t[7])<<14|(127&t[8])<<7|127&t[9];return t.slice(r+10)})(e):e}var Xt,Qt="AI_NoObjectGeneratedError",er=`vercel.ai.error.${Qt}`,tr=Symbol.for(er),rr=class extends s{constructor({message:e="No object generated.",cause:t,text:r,response:a,usage:n,finishReason:o}){super({name:Qt,message:e,cause:t}),this[Xt]=!0,this.text=r,this.response=a,this.usage=n,this.finishReason=o}static isInstance(e){return s.hasMarker(e,er)}};Xt=tr;var ar,nr="AI_DownloadError",or=`vercel.ai.error.${nr}`,sr=Symbol.for(or),ir=class extends s{constructor({url:e,statusCode:t,statusText:r,cause:a,message:n=(null==a?`Failed to download ${e}: ${t} ${r}`:`Failed to download ${e}: ${a}`)}){super({name:nr,message:n,cause:a}),this[ar]=!0,this.url=e,this.statusCode=t,this.statusText=r}static isInstance(e){return s.hasMarker(e,or)}};async function lr({url:e}){var t;const r=e.toString();try{const e=await fetch(r);if(!e.ok)throw new ir({url:r,statusCode:e.status,statusText:e.statusText});return{data:new Uint8Array(await e.arrayBuffer()),mimeType:null!=(t=e.headers.get("content-type"))?t:void 0}}catch(a){if(ir.isInstance(a))throw a;throw new ir({url:r,cause:a})}}ar=sr;var ur,cr="AI_InvalidDataContentError",pr=`vercel.ai.error.${cr}`,mr=Symbol.for(pr),dr=class extends s{constructor({content:e,cause:t,message:r=`Invalid data content. Expected a base64 string, Uint8Array, ArrayBuffer, or Buffer, but got ${typeof e}.`}){super({name:cr,message:r,cause:t}),this[ur]=!0,this.content=e}static isInstance(e){return s.hasMarker(e,pr)}};ur=mr;var fr=u([d(),h(Uint8Array),h(ArrayBuffer),_(e=>{var t,r;return null!=(r=null==(t=globalThis.Buffer)?void 0:t.isBuffer(e))&&r},{message:"Must be a Buffer"})]);function gr(e){return"string"==typeof e?e:e instanceof ArrayBuffer?$(new Uint8Array(e)):$(e)}function hr(e){if(e instanceof Uint8Array)return e;if("string"==typeof e)try{return j(e)}catch(t){throw new dr({message:"Invalid data content. Content string is not a base64-encoded media.",content:e,cause:t})}if(e instanceof ArrayBuffer)return new Uint8Array(e);throw new dr({content:e})}function yr(e){try{return(new TextDecoder).decode(e)}catch(t){throw new Error("Error decoding Uint8Array to text")}}var vr,br="AI_InvalidMessageRoleError",xr=`vercel.ai.error.${br}`,_r=Symbol.for(xr),wr=class extends s{constructor({role:e,message:t=`Invalid message role: '${e}'. Must be one of: "system", "user", "assistant", "tool".`}){super({name:br,message:t}),this[vr]=!0,this.role=e}static isInstance(e){return s.hasMarker(e,xr)}};async function Ir({prompt:e,modelSupportsImageUrls:t=!0,modelSupportsUrl:r=()=>!1,downloadImplementation:a=lr}){const n=await async function(e,t,r,a){const n=e.filter(e=>"user"===e.role).map(e=>e.content).filter(e=>Array.isArray(e)).flat().filter(e=>"image"===e.type||"file"===e.type).filter(e=>!("image"===e.type&&!0===r)).map(e=>"image"===e.type?e.image:e.data).map(e=>"string"==typeof e&&(e.startsWith("http:")||e.startsWith("https:"))?new URL(e):e).filter(e=>e instanceof URL).filter(e=>!a(e)),o=await Promise.all(n.map(async e=>({url:e,data:await t({url:e})})));return Object.fromEntries(o.map(({url:e,data:t})=>[e.toString(),t]))}(e.messages,a,t,r);return[...null!=e.system?[{role:"system",content:e.system}]:[],...e.messages.map(e=>function(e,t){var r,a,n,o,s,i;const l=e.role;switch(l){case"system":return{role:"system",content:e.content,providerMetadata:null!=(r=e.providerOptions)?r:e.experimental_providerMetadata};case"user":return"string"==typeof e.content?{role:"user",content:[{type:"text",text:e.content}],providerMetadata:null!=(a=e.providerOptions)?a:e.experimental_providerMetadata}:{role:"user",content:e.content.map(e=>function(e,t){var r,a,n,o;if("text"===e.type)return{type:"text",text:e.text,providerMetadata:null!=(r=e.providerOptions)?r:e.experimental_providerMetadata};let s,i,l,u=e.mimeType;const c=e.type;switch(c){case"image":s=e.image;break;case"file":s=e.data;break;default:throw new Error(`Unsupported part type: ${c}`)}try{i="string"==typeof s?new URL(s):s}catch(p){i=s}if(i instanceof URL)if("data:"===i.protocol){const{mimeType:e,base64Content:t}=function(e){try{const[t,r]=e.split(",");return{mimeType:t.split(";")[0].split(":")[1],base64Content:r}}catch(p){return{mimeType:void 0,base64Content:void 0}}}(i.toString());if(null==e||null==t)throw new Error(`Invalid data URL format in part ${c}`);u=e,l=hr(t)}else{const e=t[i.toString()];e?(l=e.data,null!=u||(u=e.mimeType)):l=i}else l=hr(i);switch(c){case"image":return l instanceof Uint8Array&&(u=null!=(a=function({data:e,signatures:t}){const r=Ht(e);for(const a of t)if("string"==typeof r?r.startsWith(a.base64Prefix):r.length>=a.bytesPrefix.length&&a.bytesPrefix.every((e,t)=>r[t]===e))return a.mimeType}({data:l,signatures:Gt}))?a:u),{type:"image",image:l,mimeType:u,providerMetadata:null!=(n=e.providerOptions)?n:e.experimental_providerMetadata};case"file":if(null==u)throw new Error("Mime type is missing for file part");return{type:"file",data:l instanceof Uint8Array?gr(l):l,filename:e.filename,mimeType:u,providerMetadata:null!=(o=e.providerOptions)?o:e.experimental_providerMetadata}}}(e,t)).filter(e=>"text"!==e.type||""!==e.text),providerMetadata:null!=(n=e.providerOptions)?n:e.experimental_providerMetadata};case"assistant":return"string"==typeof e.content?{role:"assistant",content:[{type:"text",text:e.content}],providerMetadata:null!=(o=e.providerOptions)?o:e.experimental_providerMetadata}:{role:"assistant",content:e.content.filter(e=>"text"!==e.type||""!==e.text).map(e=>{var t;const r=null!=(t=e.providerOptions)?t:e.experimental_providerMetadata;switch(e.type){case"file":return{type:"file",data:e.data instanceof URL?e.data:gr(e.data),filename:e.filename,mimeType:e.mimeType,providerMetadata:r};case"reasoning":return{type:"reasoning",text:e.text,signature:e.signature,providerMetadata:r};case"redacted-reasoning":return{type:"redacted-reasoning",data:e.data,providerMetadata:r};case"text":return{type:"text",text:e.text,providerMetadata:r};case"tool-call":return{type:"tool-call",toolCallId:e.toolCallId,toolName:e.toolName,args:e.args,providerMetadata:r}}}),providerMetadata:null!=(s=e.providerOptions)?s:e.experimental_providerMetadata};case"tool":return{role:"tool",content:e.content.map(e=>{var t;return{type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,result:e.result,content:e.experimental_content,isError:e.isError,providerMetadata:null!=(t=e.providerOptions)?t:e.experimental_providerMetadata}}),providerMetadata:null!=(i=e.providerOptions)?i:e.experimental_providerMetadata};default:throw new wr({role:l})}}(e,n))]}function Tr(e){var t,r,a;const n=[];for(const s of e){let e;try{e=new URL(s.url)}catch(o){throw new Error(`Invalid URL: ${s.url}`)}switch(e.protocol){case"http:":case"https:":if(null==(t=s.contentType)?void 0:t.startsWith("image/"))n.push({type:"image",image:e});else{if(!s.contentType)throw new Error("If the attachment is not an image, it must specify a content type");n.push({type:"file",data:e,mimeType:s.contentType})}break;case"data:":{let e,t,i;try{[e,t]=s.url.split(","),i=e.split(";")[0].split(":")[1]}catch(o){throw new Error(`Error processing data URL: ${s.url}`)}if(null==i||null==t)throw new Error(`Invalid data URL format: ${s.url}`);if(null==(r=s.contentType)?void 0:r.startsWith("image/"))n.push({type:"image",image:hr(t)});else if(null==(a=s.contentType)?void 0:a.startsWith("text/"))n.push({type:"text",text:yr(hr(t))});else{if(!s.contentType)throw new Error("If the attachment is not an image or text, it must specify a content type");n.push({type:"file",data:t,mimeType:s.contentType})}break}default:throw new Error(`Unsupported URL protocol: ${e.protocol}`)}}return n}vr=_r;var Ar,Sr="AI_MessageConversionError",Er=`vercel.ai.error.${Sr}`,kr=Symbol.for(Er),Rr=class extends s{constructor({originalMessage:e,message:t}){super({name:Sr,message:t}),this[Ar]=!0,this.originalMessage=e}static isInstance(e){return s.hasMarker(e,Er)}};function Nr(e,t){var r,a;const n=null!=(r=null==t?void 0:t.tools)?r:{},o=[];for(let s=0;s<e.length;s++){const t=e[s],r=s===e.length-1,{role:i,content:l,experimental_attachments:u}=t;switch(i){case"system":o.push({role:"system",content:l});break;case"user":if(null==t.parts)o.push({role:"user",content:u?[{type:"text",text:l},...Tr(u)]:l});else{const e=t.parts.filter(e=>"text"===e.type).map(e=>({type:"text",text:e.text}));o.push({role:"user",content:u?[...e,...Tr(u)]:e})}break;case"assistant":{if(null!=t.parts){let e=function(){const e=[];for(const t of i)switch(t.type){case"file":case"text":e.push(t);break;case"reasoning":for(const r of t.details)switch(r.type){case"text":e.push({type:"reasoning",text:r.text,signature:r.signature});break;case"redacted":e.push({type:"redacted-reasoning",data:r.data})}break;case"tool-invocation":e.push({type:"tool-call",toolCallId:t.toolInvocation.toolCallId,toolName:t.toolInvocation.toolName,args:t.toolInvocation.args});break;default:throw new Error(`Unsupported part: ${t}`)}o.push({role:"assistant",content:e});const a=i.filter(e=>"tool-invocation"===e.type).map(e=>e.toolInvocation);a.length>0&&o.push({role:"tool",content:a.map(e=>{if(!("result"in e))throw new Rr({originalMessage:t,message:"ToolInvocation must have a result: "+JSON.stringify(e)});const{toolCallId:r,toolName:a,result:o}=e,s=n[a];return null!=(null==s?void 0:s.experimental_toToolResultContent)?{type:"tool-result",toolCallId:r,toolName:a,result:s.experimental_toToolResultContent(o),experimental_content:s.experimental_toToolResultContent(o)}:{type:"tool-result",toolCallId:r,toolName:a,result:o}})}),i=[],s=!1,r++},r=0,s=!1,i=[];for(const n of t.parts)switch(n.type){case"text":s&&e(),i.push(n);break;case"file":case"reasoning":i.push(n);break;case"tool-invocation":(null!=(a=n.toolInvocation.step)?a:0)!==r&&e(),i.push(n),s=!0}e();break}const e=t.toolInvocations;if(null==e||0===e.length){o.push({role:"assistant",content:l});break}const s=e.reduce((e,t)=>{var r;return Math.max(e,null!=(r=t.step)?r:0)},0);for(let a=0;a<=s;a++){const s=e.filter(e=>{var t;return(null!=(t=e.step)?t:0)===a});0!==s.length&&(o.push({role:"assistant",content:[...r&&l&&0===a?[{type:"text",text:l}]:[],...s.map(({toolCallId:e,toolName:t,args:r})=>({type:"tool-call",toolCallId:e,toolName:t,args:r}))]}),o.push({role:"tool",content:s.map(e=>{if(!("result"in e))throw new Rr({originalMessage:t,message:"ToolInvocation must have a result: "+JSON.stringify(e)});const{toolCallId:r,toolName:a,result:o}=e,s=n[a];return null!=(null==s?void 0:s.experimental_toToolResultContent)?{type:"tool-result",toolCallId:r,toolName:a,result:s.experimental_toToolResultContent(o),experimental_content:s.experimental_toToolResultContent(o)}:{type:"tool-result",toolCallId:r,toolName:a,result:o}})}))}l&&!r&&o.push({role:"assistant",content:l});break}case"data":break;default:throw new Rr({originalMessage:t,message:`Unsupported role: ${i}`})}}return o}Ar=kr;var Cr=g(()=>u([b(),d(),x(),v(),m(d(),Cr),l(Cr)])),Or=m(d(),m(d(),Cr)),Pr=l(u([p({type:f("text"),text:d()}),p({type:f("image"),data:d(),mimeType:d().optional()})])),Mr=p({type:f("text"),text:d(),providerOptions:Or.optional(),experimental_providerMetadata:Or.optional()}),jr=p({type:f("image"),image:u([fr,h(URL)]),mimeType:d().optional(),providerOptions:Or.optional(),experimental_providerMetadata:Or.optional()}),$r=p({type:f("file"),data:u([fr,h(URL)]),filename:d().optional(),mimeType:d(),providerOptions:Or.optional(),experimental_providerMetadata:Or.optional()}),Dr=p({type:f("reasoning"),text:d(),providerOptions:Or.optional(),experimental_providerMetadata:Or.optional()}),Lr=p({type:f("redacted-reasoning"),data:d(),providerOptions:Or.optional(),experimental_providerMetadata:Or.optional()}),Ur=p({type:f("tool-call"),toolCallId:d(),toolName:d(),args:y(),providerOptions:Or.optional(),experimental_providerMetadata:Or.optional()}),Zr=p({type:f("tool-result"),toolCallId:d(),toolName:d(),result:y(),content:Pr.optional(),isError:v().optional(),providerOptions:Or.optional(),experimental_providerMetadata:Or.optional()}),Fr=p({role:f("system"),content:d(),providerOptions:Or.optional(),experimental_providerMetadata:Or.optional()}),Br=p({role:f("user"),content:u([d(),l(u([Mr,jr,$r]))]),providerOptions:Or.optional(),experimental_providerMetadata:Or.optional()}),Jr=p({role:f("assistant"),content:u([d(),l(u([Mr,$r,Dr,Lr,Ur]))]),providerOptions:Or.optional(),experimental_providerMetadata:Or.optional()}),qr=p({role:f("tool"),content:l(Zr),providerOptions:Or.optional(),experimental_providerMetadata:Or.optional()}),Vr=u([Fr,Br,Jr,qr]);function zr({prompt:e,tools:t}){if(null==e.prompt&&null==e.messages)throw new i({prompt:e,message:"prompt or messages must be defined"});if(null!=e.prompt&&null!=e.messages)throw new i({prompt:e,message:"prompt and messages cannot be defined at the same time"});if(null!=e.system&&"string"!=typeof e.system)throw new i({prompt:e,message:"system must be a string"});if(null!=e.prompt){if("string"!=typeof e.prompt)throw new i({prompt:e,message:"prompt must be a string"});return{type:"prompt",system:e.system,messages:[{role:"user",content:e.prompt}]}}if(null!=e.messages){const r=function(e){if(!Array.isArray(e))throw new i({prompt:e,message:["messages must be an array of CoreMessage or UIMessage",`Received non-array value: ${JSON.stringify(e)}`].join("\n"),cause:e});if(0===e.length)return"messages";const t=e.map(Yr);if(t.some(e=>"has-ui-specific-parts"===e))return"ui-messages";const r=t.findIndex(e=>"has-core-specific-parts"!==e&&"message"!==e);if(-1===r)return"messages";throw new i({prompt:e,message:["messages must be an array of CoreMessage or UIMessage",`Received message of type: "${t[r]}" at index ${r}`,`messages[${r}]: ${JSON.stringify(e[r])}`].join("\n"),cause:e})}(e.messages),a="ui-messages"===r?Nr(e.messages,{tools:t}):e.messages;if(0===a.length)throw new i({prompt:e,message:"messages must not be empty"});const n=C({value:a,schema:l(Vr)});if(!n.success)throw new i({prompt:e,message:["message must be a CoreMessage or a UI message",`Validation error: ${n.error.message}`].join("\n"),cause:n.error});return{type:"messages",messages:a,system:e.system}}throw new Error("unreachable")}function Yr(e){return"object"==typeof e&&null!==e&&("function"===e.role||"data"===e.role||"toolInvocations"in e||"parts"in e||"experimental_attachments"in e)?"has-ui-specific-parts":"object"==typeof e&&null!==e&&"content"in e&&(Array.isArray(e.content)||"experimental_providerMetadata"in e||"providerOptions"in e)?"has-core-specific-parts":"object"==typeof e&&null!==e&&"role"in e&&"content"in e&&"string"==typeof e.content&&["system","user","assistant","tool"].includes(e.role)?"message":"other"}function Kr({promptTokens:e,completionTokens:t}){return{promptTokens:e,completionTokens:t,totalTokens:e+t}}function Wr(e,t){return{promptTokens:e.promptTokens+t.promptTokens,completionTokens:e.completionTokens+t.completionTokens,totalTokens:e.totalTokens+t.totalTokens}}function Gr(e){const t=e.map(e=>({...e,content:"string"==typeof e.content?e.content:e.content.map(Hr)}));return JSON.stringify(t)}function Hr(e){return"image"===e.type?{...e,image:e.image instanceof Uint8Array?gr(e.image):e.image}:e}k({prefix:"aiobj",size:24}),k({prefix:"aiobj",size:24});var Xr,Qr="AI_NoOutputSpecifiedError",ea=`vercel.ai.error.${Qr}`,ta=Symbol.for(ea),ra=class extends s{constructor({message:e="No output specified."}={}){super({name:Qr,message:e}),this[Xr]=!0}static isInstance(e){return s.hasMarker(e,ea)}};Xr=ta;var aa,na="AI_ToolExecutionError",oa=`vercel.ai.error.${na}`,sa=Symbol.for(oa),ia=class extends s{constructor({toolArgs:e,toolName:t,toolCallId:r,cause:a,message:n=`Error executing tool ${t}: ${I(a)}`}){super({name:na,message:n,cause:a}),this[aa]=!0,this.toolArgs=e,this.toolName=t,this.toolCallId=r}static isInstance(e){return s.hasMarker(e,oa)}};function la({tools:e,toolChoice:t,activeTools:r}){if(!(null!=(a=e)&&Object.keys(a).length>0))return{tools:void 0,toolChoice:void 0};var a;return{tools:(null!=r?Object.entries(e).filter(([e])=>r.includes(e)):Object.entries(e)).map(([e,t])=>{const r=t.type;switch(r){case void 0:case"function":return{type:"function",name:e,description:t.description,parameters:Ce(t.parameters).jsonSchema};case"provider-defined":return{type:"provider-defined",name:e,id:t.id,args:t.args};default:throw new Error(`Unsupported tool type: ${r}`)}}),toolChoice:null==t?{type:"auto"}:"string"==typeof t?{type:t}:{type:"tool",toolName:t.toolName}}}aa=sa;var ua=/^([\s\S]*?)(\s+)(\S*)$/;function ca(e){const t=function(e){const t=e.match(ua);return t?{prefix:t[1],whitespace:t[2],suffix:t[3]}:void 0}(e);return t?t.prefix+t.whitespace:e}var pa,ma="AI_InvalidToolArgumentsError",da=`vercel.ai.error.${ma}`,fa=Symbol.for(da),ga=class extends s{constructor({toolArgs:e,toolName:t,cause:r,message:a=`Invalid arguments for tool ${t}: ${I(r)}`}){super({name:ma,message:a,cause:r}),this[pa]=!0,this.toolArgs=e,this.toolName=t}static isInstance(e){return s.hasMarker(e,da)}};pa=fa;var ha,ya="AI_NoSuchToolError",va=`vercel.ai.error.${ya}`,ba=Symbol.for(va),xa=class extends s{constructor({toolName:e,availableTools:t,message:r=`Model tried to call unavailable tool '${e}'. ${void 0===t?"No tools are available.":`Available tools: ${t.join(", ")}.`}`}){super({name:ya,message:r}),this[ha]=!0,this.toolName=e,this.availableTools=t}static isInstance(e){return s.hasMarker(e,va)}};ha=ba;var _a,wa="AI_ToolCallRepairError",Ia=`vercel.ai.error.${wa}`,Ta=Symbol.for(Ia),Aa=class extends s{constructor({cause:e,originalError:t,message:r=`Error repairing tool call: ${I(e)}`}){super({name:wa,message:r,cause:e}),this[_a]=!0,this.originalError=t}static isInstance(e){return s.hasMarker(e,Ia)}};async function Sa({toolCall:e,tools:t,repairToolCall:r,system:a,messages:n}){if(null==t)throw new xa({toolName:e.toolName});try{return await Ea({toolCall:e,tools:t})}catch(o){if(null==r||!xa.isInstance(o)&&!ga.isInstance(o))throw o;let i=null;try{i=await r({toolCall:e,tools:t,parameterSchema:({toolName:e})=>Ce(t[e].parameters).jsonSchema,system:a,messages:n,error:o})}catch(s){throw new Aa({cause:s,originalError:o})}if(null==i)throw o;return await Ea({toolCall:i,tools:t})}}async function Ea({toolCall:e,tools:t}){const r=e.toolName,a=t[r];if(null==a)throw new xa({toolName:e.toolName,availableTools:Object.keys(t)});const n=Ce(a.parameters),o=""===e.args.trim()?C({value:{},schema:n}):O({text:e.args,schema:n});if(!1===o.success)throw new ga({toolName:r,toolArgs:e.args,cause:o.error});return{type:"tool-call",toolCallId:e.toolCallId,toolName:r,args:o.value}}function ka(e){const t=e.filter(e=>"text"===e.type).map(e=>e.text).join("");return t.length>0?t:void 0}function Ra({text:e="",files:t,reasoning:r,tools:a,toolCalls:n,toolResults:o,messageId:s,generateMessageId:i}){const l=[],u=[];return r.length>0&&u.push(...r.map(e=>"text"===e.type?{...e,type:"reasoning"}:{...e,type:"redacted-reasoning"})),t.length>0&&u.push(...t.map(e=>({type:"file",data:e.base64,mimeType:e.mimeType}))),e.length>0&&u.push({type:"text",text:e}),n.length>0&&u.push(...n),u.length>0&&l.push({role:"assistant",content:u,id:s}),o.length>0&&l.push({role:"tool",id:i(),content:o.map(e=>{const t=a[e.toolName];return null!=(null==t?void 0:t.experimental_toToolResultContent)?{type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,result:t.experimental_toToolResultContent(e.result),experimental_content:t.experimental_toToolResultContent(e.result)}:{type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,result:e.result}})}),l}_a=Ta;var Na=k({prefix:"aitxt",size:24}),Ca=k({prefix:"msg",size:24});async function Oa({model:e,tools:t,toolChoice:r,system:a,prompt:n,messages:o,maxRetries:s,abortSignal:i,headers:l,maxSteps:u=1,experimental_generateMessageId:c=Ca,experimental_output:p,experimental_continueSteps:m=!1,experimental_telemetry:d,experimental_providerMetadata:f,providerOptions:g=f,experimental_activeTools:h,experimental_prepareStep:y,experimental_repairToolCall:v,_internal:{generateId:b=Na,currentDate:x=()=>new Date}={},onStepFinish:_,...w}){var I;if("string"==typeof e||"v1"!==e.specificationVersion)throw new Nt;if(u<1)throw new Mt({parameter:"maxSteps",value:u,message:"maxSteps must be at least 1"});const{maxRetries:T,retry:A}=function({maxRetries:e}){if(null!=e){if(!Number.isInteger(e))throw new Mt({parameter:"maxRetries",value:e,message:"maxRetries must be an integer"});if(e<0)throw new Mt({parameter:"maxRetries",value:e,message:"maxRetries must be >= 0"})}const t=null!=e?e:2;return{maxRetries:t,retry:Zt({maxRetries:t})}}({maxRetries:s}),S=function({model:e,settings:t,telemetry:r,headers:a}){var n;return{"ai.model.provider":e.provider,"ai.model.id":e.modelId,...Object.entries(t).reduce((e,[t,r])=>(e[`ai.settings.${t}`]=r,e),{}),...Object.entries(null!=(n=null==r?void 0:r.metadata)?n:{}).reduce((e,[t,r])=>(e[`ai.telemetry.metadata.${t}`]=r,e),{}),...Object.entries(null!=a?a:{}).reduce((e,[t,r])=>(void 0!==r&&(e[`ai.request.headers.${t}`]=r),e),{})}}({model:e,telemetry:d,headers:l,settings:{...w,maxRetries:T}}),E=zr({prompt:{system:null!=(I=null==p?void 0:p.injectIntoSystemPrompt({system:a,model:e}))?I:a,prompt:n,messages:o},tools:t}),k=function({isEnabled:e=!1,tracer:t}={}){return e?t||At.getTracer("ai"):Jt}(d);return zt({name:"ai.generateText",attributes:Kt({telemetry:d,attributes:{...Bt({operationId:"ai.generateText",telemetry:d}),...S,"ai.model.provider":e.provider,"ai.model.id":e.modelId,"ai.prompt":{input:()=>JSON.stringify({system:a,prompt:n,messages:o})},"ai.settings.maxSteps":u}}),tracer:k,fn:async n=>{var o,s,f,I,T,R,N,C,O,P,M,j,$,D;const L=function({maxTokens:e,temperature:t,topP:r,topK:a,presencePenalty:n,frequencyPenalty:o,stopSequences:s,seed:i}){if(null!=e){if(!Number.isInteger(e))throw new Mt({parameter:"maxTokens",value:e,message:"maxTokens must be an integer"});if(e<1)throw new Mt({parameter:"maxTokens",value:e,message:"maxTokens must be >= 1"})}if(null!=t&&"number"!=typeof t)throw new Mt({parameter:"temperature",value:t,message:"temperature must be a number"});if(null!=r&&"number"!=typeof r)throw new Mt({parameter:"topP",value:r,message:"topP must be a number"});if(null!=a&&"number"!=typeof a)throw new Mt({parameter:"topK",value:a,message:"topK must be a number"});if(null!=n&&"number"!=typeof n)throw new Mt({parameter:"presencePenalty",value:n,message:"presencePenalty must be a number"});if(null!=o&&"number"!=typeof o)throw new Mt({parameter:"frequencyPenalty",value:o,message:"frequencyPenalty must be a number"});if(null!=i&&!Number.isInteger(i))throw new Mt({parameter:"seed",value:i,message:"seed must be an integer"});return{maxTokens:e,temperature:null!=t?t:0,topP:r,topK:a,presencePenalty:n,frequencyPenalty:o,stopSequences:null!=s&&s.length>0?s:void 0,seed:i}}(w);let U,Z=[],F=[],B=[],J=0;const q=[];let V="";const z=[],Y=[];let K={completionTokens:0,promptTokens:0,totalTokens:0},W="initial";do{const n=0===J?E.type:"messages",j=[...E.messages,...q],$=await(null==y?void 0:y({model:e,steps:Y,maxSteps:u,stepNumber:J})),D=null!=(o=null==$?void 0:$.toolChoice)?o:r,G=null!=(s=null==$?void 0:$.experimental_activeTools)?s:h,H=null!=(f=null==$?void 0:$.model)?f:e,X=await Ir({prompt:{type:n,system:E.system,messages:j},modelSupportsImageUrls:H.supportsImageUrls,modelSupportsUrl:null==(I=H.supportsUrl)?void 0:I.bind(H)}),Q={type:"regular",...la({tools:t,toolChoice:D,activeTools:G})};U=await A(()=>zt({name:"ai.generateText.doGenerate",attributes:Kt({telemetry:d,attributes:{...Bt({operationId:"ai.generateText.doGenerate",telemetry:d}),...S,"ai.model.provider":H.provider,"ai.model.id":H.modelId,"ai.prompt.format":{input:()=>n},"ai.prompt.messages":{input:()=>Gr(X)},"ai.prompt.tools":{input:()=>{var e;return null==(e=Q.tools)?void 0:e.map(e=>JSON.stringify(e))}},"ai.prompt.toolChoice":{input:()=>null!=Q.toolChoice?JSON.stringify(Q.toolChoice):void 0},"gen_ai.system":H.provider,"gen_ai.request.model":H.modelId,"gen_ai.request.frequency_penalty":w.frequencyPenalty,"gen_ai.request.max_tokens":w.maxTokens,"gen_ai.request.presence_penalty":w.presencePenalty,"gen_ai.request.stop_sequences":w.stopSequences,"gen_ai.request.temperature":w.temperature,"gen_ai.request.top_k":w.topK,"gen_ai.request.top_p":w.topP}}),tracer:k,fn:async t=>{var r,a,o,s,u,c;const m=await H.doGenerate({mode:Q,...L,inputFormat:n,responseFormat:null==p?void 0:p.responseFormat({model:e}),prompt:X,providerMetadata:g,abortSignal:i,headers:l}),f={id:null!=(a=null==(r=m.response)?void 0:r.id)?a:b(),timestamp:null!=(s=null==(o=m.response)?void 0:o.timestamp)?s:x(),modelId:null!=(c=null==(u=m.response)?void 0:u.modelId)?c:H.modelId};return t.setAttributes(Kt({telemetry:d,attributes:{"ai.response.finishReason":m.finishReason,"ai.response.text":{output:()=>m.text},"ai.response.toolCalls":{output:()=>JSON.stringify(m.toolCalls)},"ai.response.id":f.id,"ai.response.model":f.modelId,"ai.response.timestamp":f.timestamp.toISOString(),"ai.response.providerMetadata":JSON.stringify(m.providerMetadata),"ai.usage.promptTokens":m.usage.promptTokens,"ai.usage.completionTokens":m.usage.completionTokens,"gen_ai.response.finish_reasons":[m.finishReason],"gen_ai.response.id":f.id,"gen_ai.response.model":f.modelId,"gen_ai.usage.input_tokens":m.usage.promptTokens,"gen_ai.usage.output_tokens":m.usage.completionTokens}})),{...m,response:f}}})),Z=await Promise.all((null!=(T=U.toolCalls)?T:[]).map(e=>Sa({toolCall:e,tools:t,repairToolCall:v,system:a,messages:j}))),F=null==t?[]:await Pa({toolCalls:Z,tools:t,tracer:k,telemetry:d,messages:j,abortSignal:i});const ee=Kr(U.usage);K=Wr(K,ee);let te="done";++J<u&&(m&&"length"===U.finishReason&&0===Z.length?te="continue":Z.length>0&&F.length===Z.length&&(te="tool-result"));const re=null!=(R=U.text)?R:"",ae="continue"===W&&V.trimEnd()!==V?re.trimStart():re,ne="continue"===te?ca(ae):ae;if(V="continue"===te||"continue"===W?V+ne:ne,B=ja(U.reasoning),z.push(...null!=(N=U.sources)?N:[]),"continue"===W){const e=q[q.length-1];"string"==typeof e.content?e.content+=ne:e.content.push({text:ne,type:"text"})}else q.push(...Ra({text:V,files:$a(U.files),reasoning:ja(U.reasoning),tools:null!=t?t:{},toolCalls:Z,toolResults:F,messageId:c(),generateMessageId:c}));const oe={stepType:W,text:ne,reasoning:ka(B),reasoningDetails:B,files:$a(U.files),sources:null!=(C=U.sources)?C:[],toolCalls:Z,toolResults:F,finishReason:U.finishReason,usage:ee,warnings:U.warnings,logprobs:U.logprobs,request:null!=(O=U.request)?O:{},response:{...U.response,headers:null==(P=U.rawResponse)?void 0:P.headers,body:null==(M=U.rawResponse)?void 0:M.body,messages:structuredClone(q)},providerMetadata:U.providerMetadata,experimental_providerMetadata:U.providerMetadata,isContinued:"continue"===te};Y.push(oe),await(null==_?void 0:_(oe)),W=te}while("done"!==W);return n.setAttributes(Kt({telemetry:d,attributes:{"ai.response.finishReason":U.finishReason,"ai.response.text":{output:()=>U.text},"ai.response.toolCalls":{output:()=>JSON.stringify(U.toolCalls)},"ai.usage.promptTokens":U.usage.promptTokens,"ai.usage.completionTokens":U.usage.completionTokens,"ai.response.providerMetadata":JSON.stringify(U.providerMetadata)}})),new Ma({text:V,files:$a(U.files),reasoning:ka(B),reasoningDetails:B,sources:z,outputResolver:()=>{if(null==p)throw new ra;return p.parseOutput({text:V},{response:U.response,usage:K,finishReason:U.finishReason})},toolCalls:Z,toolResults:F,finishReason:U.finishReason,usage:K,warnings:U.warnings,request:null!=(j=U.request)?j:{},response:{...U.response,headers:null==($=U.rawResponse)?void 0:$.headers,body:null==(D=U.rawResponse)?void 0:D.body,messages:q},logprobs:U.logprobs,steps:Y,providerMetadata:U.providerMetadata})}})}async function Pa({toolCalls:e,tools:t,tracer:r,telemetry:a,messages:n,abortSignal:o}){return(await Promise.all(e.map(async({toolCallId:e,toolName:s,args:i})=>{const l=t[s];if(null==(null==l?void 0:l.execute))return;const u=await zt({name:"ai.toolCall",attributes:Kt({telemetry:a,attributes:{...Bt({operationId:"ai.toolCall",telemetry:a}),"ai.toolCall.name":s,"ai.toolCall.id":e,"ai.toolCall.args":{output:()=>JSON.stringify(i)}}}),tracer:r,fn:async t=>{try{const s=await l.execute(i,{toolCallId:e,messages:n,abortSignal:o});try{t.setAttributes(Kt({telemetry:a,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(s)}}}))}catch(r){}return s}catch(u){throw Yt(t,u),new ia({toolCallId:e,toolName:s,toolArgs:i,cause:u})}}});return{type:"tool-result",toolCallId:e,toolName:s,args:i,result:u}}))).filter(e=>null!=e)}var Ma=class{constructor(e){this.text=e.text,this.files=e.files,this.reasoning=e.reasoning,this.reasoningDetails=e.reasoningDetails,this.toolCalls=e.toolCalls,this.toolResults=e.toolResults,this.finishReason=e.finishReason,this.usage=e.usage,this.warnings=e.warnings,this.request=e.request,this.response=e.response,this.steps=e.steps,this.experimental_providerMetadata=e.providerMetadata,this.providerMetadata=e.providerMetadata,this.logprobs=e.logprobs,this.outputResolver=e.outputResolver,this.sources=e.sources}get experimental_output(){return this.outputResolver()}};function ja(e){return null==e?[]:"string"==typeof e?[{type:"text",text:e}]:e}function $a(e){var t;return null!=(t=null==e?void 0:e.map(e=>new Wt(e)))?t:[]}var Da={};Et(Da,{object:()=>Ua,text:()=>La});var La=()=>({type:"text",responseFormat:()=>({type:"text"}),injectIntoSystemPrompt:({system:e})=>e,parsePartial:({text:e})=>({partial:e}),parseOutput:({text:e})=>e}),Ua=({schema:e})=>{const t=Ce(e);return{type:"object",responseFormat:({model:e})=>({type:"json",schema:e.supportsStructuredOutputs?t.jsonSchema:void 0}),injectIntoSystemPrompt:({system:e,model:r})=>r.supportsStructuredOutputs?e:function({prompt:e,schema:t,schemaPrefix:r=(null!=t?"JSON schema:":void 0),schemaSuffix:a=(null!=t?"You MUST answer with a JSON object that matches the JSON schema above.":"You MUST answer with JSON.")}){return[null!=e&&e.length>0?e:void 0,null!=e&&e.length>0?"":void 0,r,null!=t?JSON.stringify(t):void 0,a].filter(e=>null!=e).join("\n")}({prompt:e,schema:t.jsonSchema}),parsePartial({text:e}){const t=function(e){if(void 0===e)return{value:void 0,state:"undefined-input"};let t=O({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=O({text:Ae(e)}),t.success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}(e);switch(t.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:t.value};default:{const e=t.state;throw new Error(`Unsupported parse state: ${e}`)}}},parseOutput({text:e},r){const a=O({text:e});if(!a.success)throw new rr({message:"No object generated: could not parse the response.",cause:a.error,text:e,response:r.response,usage:r.usage,finishReason:r.finishReason});const n=C({value:a.value,schema:t});if(!n.success)throw new rr({message:"No object generated: response did not match schema.",cause:n.error,text:e,response:r.response,usage:r.usage,finishReason:r.finishReason});return n.value}}};function Za(e,t){const r=e.getReader(),a=t.getReader();let n,o,s=!1,i=!1;async function l(e){try{null==n&&(n=r.read());const t=await n;n=void 0,t.done?e.close():e.enqueue(t.value)}catch(t){e.error(t)}}async function u(e){try{null==o&&(o=a.read());const t=await o;o=void 0,t.done?e.close():e.enqueue(t.value)}catch(t){e.error(t)}}return new ReadableStream({async pull(e){try{if(s)return void(await u(e));if(i)return void(await l(e));null==n&&(n=r.read()),null==o&&(o=a.read());const{result:t,reader:c}=await Promise.race([n.then(e=>({result:e,reader:r})),o.then(e=>({result:e,reader:a}))]);t.done||e.enqueue(t.value),c===r?(n=void 0,t.done&&(await u(e),s=!0)):(o=void 0,t.done&&(i=!0,await l(e)))}catch(t){e.error(t)}},cancel(){r.cancel(),a.cancel()}})}k({prefix:"aitxt",size:24}),k({prefix:"msg",size:24});var Fa=p({name:d(),version:d()}).passthrough(),Ba=p({_meta:w(p({}).passthrough())}).passthrough(),Ja=Ba,qa=p({method:d(),params:w(Ba)}),Va=p({experimental:w(p({}).passthrough()),logging:w(p({}).passthrough()),prompts:w(p({listChanged:w(v())}).passthrough()),resources:w(p({subscribe:w(v()),listChanged:w(v())}).passthrough()),tools:w(p({listChanged:w(v())}).passthrough())}).passthrough();Ja.extend({protocolVersion:d(),capabilities:Va,serverInfo:Fa,instructions:w(d())});var za=Ja.extend({nextCursor:w(d())}),Ya=p({name:d(),description:w(d()),inputSchema:p({type:f("object"),properties:w(p({}).passthrough())}).passthrough()}).passthrough();za.extend({tools:l(Ya)});var Ka=p({type:f("text"),text:d()}).passthrough(),Wa=p({type:f("image"),data:d().base64(),mimeType:d()}).passthrough(),Ga=p({uri:d(),mimeType:w(d())}).passthrough(),Ha=Ga.extend({text:d()}),Xa=Ga.extend({blob:d().base64()}),Qa=p({type:f("resource"),resource:u([Ha,Xa])}).passthrough();Ja.extend({content:l(u([Ka,Wa,Qa])),isError:v().default(!1).optional()}).or(Ja.extend({toolResult:y()}));var en="2.0",tn=p({jsonrpc:f(en),id:u([d(),x().int()])}).merge(qa).strict(),rn=p({jsonrpc:f(en),id:u([d(),x().int()]),result:Ja}).strict(),an=p({jsonrpc:f(en),id:u([d(),x().int()]),error:p({code:x().int(),message:d(),data:w(y())})}).strict(),nn=p({jsonrpc:f(en)}).merge(p({method:d(),params:w(Ba)})).strict();u([tn,nn,rn,an]);var on={};function sn(e={}){const t=new TextEncoder;let r="";return new TransformStream({async start(){e.onStart&&await e.onStart()},async transform(a,n){n.enqueue(t.encode(a)),r+=a,e.onToken&&await e.onToken(a),e.onText&&"string"==typeof a&&await e.onText(a)},async flush(){e.onCompletion&&await e.onCompletion(r),e.onFinal&&await e.onFinal(r)}})}function ln(e,t){return e.pipeThrough(new TransformStream({transform:async(e,t)=>{var r;"string"!=typeof e?"event"in e?"on_chat_model_stream"===e.event&&mn(null==(r=e.data)?void 0:r.chunk,t):mn(e,t):t.enqueue(e)}})).pipeThrough(sn(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(e,t)=>{t.enqueue(Ee("text",e))}}))}function un(e,t){return ln(e,t).pipeThrough(new TextEncoderStream)}function cn(e,t){var r;const a=ln(e,null==t?void 0:t.callbacks).pipeThrough(new TextEncoderStream),n=null==t?void 0:t.data,o=null==t?void 0:t.init,s=n?Za(n.stream,a):a;return new Response(s,{status:null!=(r=null==o?void 0:o.status)?r:200,statusText:null==o?void 0:o.statusText,headers:kt(null==o?void 0:o.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function pn(e,t){t.dataStream.merge(ln(e,t.callbacks))}function mn(e,t){if("string"==typeof e.content)t.enqueue(e.content);else{const r=e.content;for(const e of r)"text"===e.type&&t.enqueue(e.text)}}Et(on,{mergeIntoDataStream:()=>pn,toDataStream:()=>un,toDataStreamResponse:()=>cn});var dn={};function fn(e,t){const r=function(){let e=!0;return t=>(e&&(t=t.trimStart())&&(e=!1),t)}();return(a=e[Symbol.asyncIterator](),new ReadableStream({async pull(e){try{const{value:t,done:r}=await a.next();r?e.close():e.enqueue(t)}catch(t){e.error(t)}},cancel(){}})).pipeThrough(new TransformStream({async transform(e,t){t.enqueue(r(e.delta))}})).pipeThrough(sn(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(e,t)=>{t.enqueue(Ee("text",e))}}));var a}function gn(e,t){return fn(e,t).pipeThrough(new TextEncoderStream)}function hn(e,t={}){var r;const{init:a,data:n,callbacks:o}=t,s=fn(e,o).pipeThrough(new TextEncoderStream),i=n?Za(n.stream,s):s;return new Response(i,{status:null!=(r=null==a?void 0:a.status)?r:200,statusText:null==a?void 0:a.statusText,headers:kt(null==a?void 0:a.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function yn(e,t){t.dataStream.merge(fn(e,t.callbacks))}Et(dn,{mergeIntoDataStream:()=>yn,toDataStream:()=>gn,toDataStreamResponse:()=>hn});export{s as AISDKError,c as APICallError,ir as DownloadError,T as EmptyResponseBodyError,Mt as InvalidArgumentError,dr as InvalidDataContentError,wr as InvalidMessageRoleError,i as InvalidPromptError,A as InvalidResponseDataError,ga as InvalidToolArgumentsError,n as JSONParseError,on as LangChainAdapter,dn as LlamaIndexAdapter,S as LoadAPIKeyError,Rr as MessageConversionError,rr as NoObjectGeneratedError,ra as NoOutputSpecifiedError,xa as NoSuchToolError,Da as Output,Ut as RetryError,Aa as ToolCallRepairError,ia as ToolExecutionError,r as TypeValidationError,E as UnsupportedFunctionalityError,Nt as UnsupportedModelVersionError,Nr as convertToCoreMessages,Jr as coreAssistantMessageSchema,Vr as coreMessageSchema,Fr as coreSystemMessageSchema,qr as coreToolMessageSchema,Br as coreUserMessageSchema,k as createIdGenerator,Ee as formatDataStreamPart,Oa as generateText,Ne as jsonSchema,ke as zodSchema};
//# sourceMappingURL=index-hlhVkYGu.js.map
